<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Study Tracker</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { font-family: Arial; background:#eef; padding:10px; }

table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #999; padding:5px; text-align:center; }

button { width:100%; padding:6px; }

.charts{
  margin-top:20px;
}
</style>

</head>

<body>

<h2 id="monthTitle"></h2>

<table>

<tr>
<th>Science</th>

<th colspan="4">Week 1</th>
<th colspan="4">Week 2</th>
<th colspan="4">Week 3</th>
<th colspan="4">Week 4</th>
</tr>

<tbody id="mainTable"></tbody>

</table>

<div class="charts">
<canvas id="donutMath"></canvas>
<canvas id="donutPC"></canvas>
<canvas id="donutSVT"></canvas>

<canvas id="line"></canvas>
</div>

<script>

// ====== POINT SYSTEM ======

const math = [20,20,20,40];
const pc   = [25,20,35,20];
const svt  = [20,20,45,15];

// empty data
let progress = {
math: Array(16).fill(0),
pc:   Array(16).fill(0),
svt:  Array(16).fill(0)
};

// month title
document.getElementById("monthTitle").innerText =
"Progress - " + new Date().toLocaleString("default",{month:"long"});


// build table

function row(name,arr){

let html = `<tr><td><b>${name}</b></td>`;

for(let i=0;i<16;i++){

let pts = arr[i%4];

html += `<td>
<button onclick="add('${name}',${i},${pts})">
${pts}
</button>
</td>`;
}

html += "</tr>";

return html;
}

document.getElementById("mainTable").innerHTML =
row("math",math) +
row("pc",pc) +
row("svt",svt);


// when press button

function add(science,index,points){

let percent = points / 4;

progress[science][index] = percent;

update();
}


// helper sum

function total(a){
return a.reduce((x,y)=>x+y,0);
}


// ===== DONUT CHARTS =====

let donutMath = new Chart(document.getElementById("donutMath"),{
type:"doughnut",
data:{
labels:["Math","Remaining"],
datasets:[{
data:[0,100],
backgroundColor:["#ff4d4d","#ddd"]
}]
},
options:{plugins:{title:{display:true,text:"Math"}}}
});


let donutPC = new Chart(document.getElementById("donutPC"),{
type:"doughnut",
data:{
labels:["PC","Remaining"],
datasets:[{
data:[0,100],
backgroundColor:["#4caf50","#ddd"]
}]
},
options:{plugins:{title:{display:true,text:"PC"}}}
});


let donutSVT = new Chart(document.getElementById("donutSVT"),{
type:"doughnut",
data:{
labels:["SVT","Remaining"],
datasets:[{
data:[0,100],
backgroundColor:["#2196f3","#ddd"]
}]
},
options:{plugins:{title:{display:true,text:"SVT"}}}
});


// ===== LINE CHART =====

let line = new Chart(document.getElementById("line"),{

type:"line",

data:{

labels:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],

datasets:[

{
label:"Math",
data:progress.math,
borderColor:"#ff4d4d",
fill:false
},

{
label:"PC",
data:progress.pc,
borderColor:"#4caf50",
fill:false
},

{
label:"SVT",
data:progress.svt,
borderColor:"#2196f3",
fill:false
}

]

},

options:{
plugins:{title:{display:true,text:"Progress Line (%)"}},
scales:{y:{min:0,max:25}}
}

});


// ===== UPDATE FUNCTION =====

function update(){

let m = total(progress.math);
let p = total(progress.pc);
let s = total(progress.svt);

// update donuts

donutMath.data.datasets[0].data=[m,100-m];
donutPC.data.datasets[0].data=[p,100-p];
donutSVT.data.datasets[0].data=[s,100-s];

donutMath.update();
donutPC.update();
donutSVT.update();

// update line

line.data.datasets[0].data = progress.math;
line.data.datasets[1].data = progress.pc;
line.data.datasets[2].data = progress.svt;

line.update();
}


// ===== DAILY REMINDER =====

if(Notification.permission!="granted")
Notification.requestPermission();

setInterval(()=>{

let d = new Date();

if(d.getHours()==11 && d.getMinutes()==0){
new Notification("Study Tracker: Enter today's points!");
}

},60000);

</script>

</body>
  </html>
